# IGA API Configuration for SparrowVision Integration
# Copy this file to .env and fill in your actual values

# =============================================================================
# CORE IGA API SETTINGS
# =============================================================================

# JumpCloud Configuration (Primary)
IGA_API_URL=https://console.jumpcloud.com/api
IGA_API_KEY=your_jumpcloud_api_key_here
IGA_ORG_ID=your_jumpcloud_org_id_here

# Alternative: Okta Configuration
# IGA_API_URL=https://your-domain.okta.com/api/v1
# IGA_API_KEY=your_okta_api_token_here
# IGA_ORG_ID=your_okta_org_id_here

# Alternative: Azure AD Configuration  
# IGA_API_URL=https://graph.microsoft.com/v1.0
# IGA_API_KEY=your_azure_bearer_token_here
# IGA_ORG_ID=your_tenant_id_here

# Alternative: Google Workspace Configuration
# IGA_API_URL=https://admin.googleapis.com/admin/directory/v1
# IGA_API_KEY=your_google_access_token_here
# IGA_ORG_ID=your_google_domain_here

# =============================================================================
# REQUEST CONFIGURATION
# =============================================================================

# API request timeout in seconds
IGA_TIMEOUT=30

# Maximum number of retry attempts for failed requests
IGA_MAX_RETRIES=3

# Delay between retry attempts (seconds)
IGA_RETRY_DELAY=2

# Number of users to fetch per API call (pagination)
IGA_PAGE_SIZE=100

# Delay between API calls to respect rate limits (seconds)
IGA_RATE_LIMIT_DELAY=0.5

# =============================================================================
# SPARROWVISION INTEGRATION
# =============================================================================

# SparrowVision API endpoint for user import
SPARROWVISION_API_URL=https://your-sparrowvision-instance.com/api

# SparrowVision API key for authentication
SPARROWVISION_API_KEY=your_sparrowvision_api_key_here

# Enable automatic sync to SparrowVision (true/false)
AUTO_SYNC_TO_SPARROWVISION=false

# Sync schedule in cron format (if using scheduler)
SYNC_SCHEDULE=0 */6 * * *  # Every 6 hours

# =============================================================================
# SECURITY SETTINGS
# =============================================================================

# Enable encrypted storage of API keys (true/false)
ENCRYPT_CREDENTIALS=true

# Encryption key for sensitive data (generate with: openssl rand -base64 32)
ENCRYPTION_KEY=your_32_character_encryption_key_here

# Enable audit logging (true/false)
ENABLE_AUDIT_LOGGING=true

# =============================================================================
# NOTIFICATION SETTINGS
# =============================================================================

# Slack webhook for sync notifications
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK

# Email settings for notifications
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=notifications@yourcompany.com
SMTP_PASSWORD=your_app_password_here
NOTIFICATION_RECIPIENTS=admin@yourcompany.com,security@yourcompany.com

# =============================================================================
# DATABASE SETTINGS (Optional - for direct sync)
# =============================================================================

# PostgreSQL connection for SparrowVision database
DB_HOST=localhost
DB_PORT=5432
DB_NAME=sparrowvision
DB_USER=sparrowvision_sync
DB_PASSWORD=your_db_password_here
DB_SSL_MODE=require

# =============================================================================
# RISK ASSESSMENT CONFIGURATION
# =============================================================================

# Risk score thresholds
HIGH_RISK_THRESHOLD=70
MEDIUM_RISK_THRESHOLD=40
LOW_RISK_THRESHOLD=20

# Inactive user threshold (days)
INACTIVE_USER_DAYS=30

# Privileged user detection keywords (comma-separated)
PRIVILEGED_KEYWORDS=admin,administrator,root,superuser,privileged,sudo,manager

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Log file location
LOG_FILE=./logs/iga_sync.log

# Maximum log file size (MB)
LOG_MAX_SIZE=10

# Number of backup log files to keep
LOG_BACKUP_COUNT=5

# Enable JSON structured logging (true/false)
JSON_LOGGING=false

# =============================================================================
# DEVELOPMENT/TESTING SETTINGS
# =============================================================================

# Enable dry run mode (no actual changes)
DRY_RUN=false

# Mock API responses for testing
MOCK_API=false

# Enable debug mode with verbose logging
DEBUG_MODE=false

# Test data file for mock responses
TEST_DATA_FILE=./test_data/mock_users.json
